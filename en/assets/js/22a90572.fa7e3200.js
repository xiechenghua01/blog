"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[10385],{10864:function(n,e,s){s.r(e),s.d(e,{assets:function(){return l},contentTitle:function(){return a},frontMatter:function(){return c},metadata:function(){return t},toc:function(){return o}});var r=s(85893),i=s(11151);const c={id:"docusaurus-search",slug:"/docusaurus-search",title:"\u641c\u7d22",authors:"kuizuo"},a=void 0,t={unversionedId:"skill/docusaurus/docusaurus-search",id:"skill/docusaurus/docusaurus-search",title:"\u641c\u7d22",description:"\u641c\u7d22 | Docusaurus",source:"@site/docs/skill/docusaurus/search.md",sourceDirName:"skill/docusaurus",slug:"/docusaurus-search",permalink:"/en/docs/docusaurus-search",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"docusaurus-search",slug:"/docusaurus-search",title:"\u641c\u7d22",authors:"kuizuo"},sidebar:"skill",previous:{title:"\u63d2\u4ef6",permalink:"/en/docs/docusaurus-plugin"},next:{title:"\u8bc4\u8bba\u670d\u52a1",permalink:"/en/docs/docusaurus-comment"}},l={},o=[{value:"algolia",id:"algolia",level:2},{value:"\u65b9\u68481",id:"\u65b9\u68481",level:3},{value:"\u65b9\u68482",id:"\u65b9\u68482",level:3},{value:"\u4f7f\u7528 github-actions",id:"\u4f7f\u7528-github-actions",level:4},{value:"\u672c\u5730\u641c\u7d22",id:"\u672c\u5730\u641c\u7d22",level:2}];function u(n){const e=Object.assign({blockquote:"blockquote",p:"p",a:"a",h2:"h2",ol:"ol",li:"li",strong:"strong",h3:"h3",img:"img",code:"code",pre:"pre",h4:"h4"},(0,i.ah)(),n.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://docusaurus.io/zh-CN/docs/search",children:"\u641c\u7d22 | Docusaurus"})}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"algolia",children:(0,r.jsx)(e.a,{href:"https://www.algolia.com/",children:"algolia"})}),"\n",(0,r.jsx)(e.p,{children:"\u6709\u4e24\u79cd\u65b9\u6848\u6765\u914d\u7f6e algolia\u3002"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["\u8ba9 Docsearch\uff08\u51c6\u786e\u6765\u8bf4\u662f ",(0,r.jsx)(e.a,{href:"https://crawler.algolia.com/",children:"Algolia Crawler"}),"\uff09 \u6bcf\u5468\u4e00\u6b21\u722c\u53d6\u4f60\u7684\u7f51\u7ad9\uff08\u4e5f\u53ef\u81ea\u884c\u722c\u53d6\uff09\uff0c",(0,r.jsx)(e.strong,{children:"\u524d\u63d0\u662f\u9879\u76ee\u5f00\u6e90\uff0c\u5426\u5219\u6536\u8d39"}),"\uff0c\u597d\u5904\u662f\u65e0\u9700\u989d\u5916\u914d\u7f6e\uff0c\u7533\u8bf7\u6bd4\u8f83\u7e41\u7410\uff08\u672c\u535a\u5ba2\u76ee\u524d\u91c7\u7528\u7684\u65b9\u5f0f\uff09"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u81ea\u5df1\u8fd0\u884c DocSearch \u722c\u866b\uff0c\u53ef\u4ee5\u968f\u65f6\u722c\u53d6\uff0c\u4f46\u9700\u8981\u81ea\u884c\u53bb\u6ce8\u518c\u8d26\u53f7\u548c\u642d\u5efa\u722c\u866b\u73af\u5883\uff0c\u6216\u8005\u4f7f\u7528 Github Actions \u6765\u5e2e\u6211\u4eec\u722c\u53d6\u3002"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u65b9\u68481",children:"\u65b9\u68481"}),"\n",(0,r.jsxs)(e.p,{children:["\u5173\u4e8e\u7533\u8bf7 Algolia DocSearch \u5728\u6587\u6863\u4e2d\u6709\u8be6\u7ec6\u4ecb\u7ecd\uff0c\u4e3b\u8981\u662f\u8981\u7533\u8bf7\u9ebb\u70e6\uff0c\u9700\u8981\u7b49\u5f85\u90ae\u7bb1\uff0c\u5e76\u4e14\u8fd8\u9700\u8981\u56de\u590d\u5185\u5bb9\u7ed9\u5bf9\u65b9\u8fdb\u884c\u786e\u8ba4\u3002\u6240\u4ee5\u514d\u8d39\u6258\u7ba1\u7684 DocSearch \u6761\u4ef6\u662f\uff0c\u6bd4\u8f83\u82db\u523b\u7684\uff0c\u4f46\u7533\u8bf7\u5b8c\u51e0\u4e4e\u662f\u4e00\u52b3\u6c38\u9038\uff0c\u4e5f\u662f\u6211\u975e\u5e38\u63a8\u8350\u7684\u3002\u5982\u679c\u7533\u8bf7\u6210\u529f\u540e\u5c31\u53ef\u4ee5\u5728 ",(0,r.jsx)(e.a,{href:"https://crawler.algolia.com/admin/crawlers",children:"Crawler Admin Console"})," \u4e2d\u67e5\u770b"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://img.kuizuo.cn/image-20220627232545640.png",alt:"image-20220627232545640"})}),"\n",(0,r.jsxs)(e.p,{children:["\u7136\u540e\u5c06\u5f97\u5230 algolia \u7684 appId\uff0capiKey\uff0cindexName \u586b\u5199\u5230 ",(0,r.jsx)(e.code,{children:"docusaurus.config.js"})," \u4e2d\u5373\u53ef\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",metastring:"title='docusaurus.config.js'",children:"algolia: {\n  appId: 'GV6YN1ODMO',\n  apiKey: '50303937b0e4630bec4a20a14e3b7872',\n  indexName: 'kuizuo',\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u722c\u53d6\u5b8c\u6bd5\u540e\u8fd8\u4f1a\u5b9a\u65f6\u53d1\u9001\u5230\u4f60\u90ae\u7bb1"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://img.kuizuo.cn/image-20230219144035031.png",alt:"image-20230219144035031"})}),"\n",(0,r.jsx)(e.h3,{id:"\u65b9\u68482",children:"\u65b9\u68482"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://docsearch.algolia.com/docs/run-your-own",children:"Run your own | DocSearch (algolia.com)"})}),"\n",(0,r.jsx)(e.p,{children:"\u56e0\u4e3a\u65b9\u68481\u662f\u771f\u7684\u96be\u7533\u8bf7\uff0c\u6781\u5927\u6982\u7387\u4f1a\u5931\u8d25\uff0c\u65e0\u5948\u53ea\u80fd\u91c7\u7528\u65b9\u68482\u3002"}),"\n",(0,r.jsxs)(e.p,{children:["\u9996\u5148\u53bb\u7533\u8bf7 ",(0,r.jsx)(e.a,{href:"https://www.algolia.com/",children:"Algolia"})," \u8d26\u53f7\uff0c\u7136\u540e\u5728\u5de6\u4fa7 indices \u521b\u5efa\u7d22\u5f15\uff0c\u5728 API Keys \u4e2d\u83b7\u53d6 Application ID \u548c API Key\uff08\u6ce8\u610f\uff0c\u6709\u4e24\u4e2a API KEY\uff09"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://img.kuizuo.cn/image-20210821230135749.png",alt:"image-20210821230135749"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://img.kuizuo.cn/image-20210821230232837.png",alt:"image-20210821230232837"})}),"\n",(0,r.jsxs)(e.p,{children:["\u586b\u5165\u5230 ",(0,r.jsx)(e.code,{children:"docusaurus.config.js"})," \u4e2d\u7684 API KEY \u662f ",(0,r.jsx)(e.strong,{children:"Search-Only API Key"})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:'themeConfig: {\n    algolia: {\n      apiKey: "xxxxxxxxxxx",\n      appId: "xxxxxxxxxxx",\n      indexName: "kuizuo",\n    },\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u7cfb\u7edf\u6211\u9009\u7528\u7684\u662f Linux\uff0c\u5728 Docker \u7684\u73af\u5883\u4e0b\u8fd0\u884c\u722c\u866b\u4ee3\u7801\u3002\u4e0d\u8fc7\u8981\u5148 ",(0,r.jsx)(e.a,{href:"https://github.com/stedolan/jq/wiki/Installation#zero-install",children:"\u5b89\u88c5 jq"})," \u6211\u8fd9\u91cc\u9009\u62e9\u7684\u662f 0install \u8fdb\u884c\u5b89\u88c5\uff08\u5b89\u88c5\u53ef\u80fd\u7a0d\u6162\uff09\uff0c\u5177\u4f53\u53ef\u4ee5\u67e5\u770b\u6587\u6863\uff0c\u7136\u540e\u5728\u63a7\u5236\u53f0\u67e5\u770b\u5b89\u88c5\u7ed3\u679c"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"[root@kzserver kuizuo.cn]# jq --version\njq-1.6\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u63a5\u7740\u5728\u4efb\u610f\u76ee\u5f55\u4e2d\u521b\u5efa ",(0,r.jsx)(e.code,{children:".env"})," \u6587\u4ef6\uff0c\u586b\u5165\u5bf9\u5e94\u7684 APPID \u548c API KEY\uff08\u8fd9\u91cc\u662f",(0,r.jsx)(e.code,{children:"Admin API Key"}),"\uff0c\u5f53\u65f6\u6211\u8fd8\u4e00\u76f4\u4ee5\u4e3a\u662f Search API Key \u5751\u4e86\u6211\u534a\u5929 \ud83d\ude2d\uff09"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"APPLICATION_ID = YOUR_APP_ID;\nAPI_KEY = YOUR_API_KEY;\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u7136\u540e\u521b\u5efa ",(0,r.jsx)(e.code,{children:"docsearch.json"})," \u6587\u4ef6\u5230\u9879\u76ee\u76ee\u5f55\u4e0b\uff0c\u5176\u5185\u5bb9\u53ef\u4ee5\u53c2\u8003\u5982\u4e0b\uff08\u5c06\u9ad8\u4eae\u90e8\u5206\u66ff\u6362\u6210\u4f60\u7684\u7f51\u7ad9\uff09"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",metastring:"title='docsearch.json' {2-4}",children:'{\n  "index_name": "xxxx",\n  "start_urls": ["https://example.com"],\n  "sitemap_urls": ["https://example.com"],\n  "selectors": {\n    "lvl0": {\n      "selector": "(//ul[contains(@class,\'menu__list\')]//a[contains(@class, \'menu__link menu__link--sublist menu__link--active\')]/text() | //nav[contains(@class, \'navbar\')]//a[contains(@class, \'navbar__link--active\')]/text())[last()]",\n      "type": "xpath",\n      "global": true,\n      "default_value": "Documentation"\n    },\n    "lvl1": "header h1, article h1",\n    "lvl2": "article h2",\n    "lvl3": "article h3",\n    "lvl4": "article h4",\n    "lvl5": "article h5, article td:first-child",\n    "lvl6": "article h6",\n    "text": "article p, article li, article td:last-child"\n  },\n  "custom_settings": {\n    "attributesForFaceting": [\n      "type",\n      "lang",\n      "language",\n      "version",\n      "docusaurus_tag"\n    ],\n    "attributesToRetrieve": [\n      "hierarchy",\n      "content",\n      "anchor",\n      "url",\n      "url_without_anchor",\n      "type"\n    ],\n    "attributesToHighlight": ["hierarchy", "content"],\n    "attributesToSnippet": ["content:10"],\n    "camelCaseAttributes": ["hierarchy", "content"],\n    "searchableAttributes": [\n      "unordered(hierarchy.lvl0)",\n      "unordered(hierarchy.lvl1)",\n      "unordered(hierarchy.lvl2)",\n      "unordered(hierarchy.lvl3)",\n      "unordered(hierarchy.lvl4)",\n      "unordered(hierarchy.lvl5)",\n      "unordered(hierarchy.lvl6)",\n      "content"\n    ],\n    "distinct": true,\n    "attributeForDistinct": "url",\n    "customRanking": [\n      "desc(weight.pageRank)",\n      "desc(weight.level)",\n      "asc(weight.position)"\n    ],\n    "ranking": [\n      "words",\n      "filters",\n      "typo",\n      "attribute",\n      "proximity",\n      "exact",\n      "custom"\n    ],\n    "highlightPreTag": "<span class=\'algolia-docsearch-suggestion--highlight\'>",\n    "highlightPostTag": "</span>",\n    "minWordSizefor1Typo": 3,\n    "minWordSizefor2Typos": 7,\n    "allowTyposOnNumericTokens": false,\n    "minProximity": 1,\n    "ignorePlurals": true,\n    "advancedSyntax": true,\n    "attributeCriteriaComputedByMinProximity": true,\n    "removeWordsIfNoResults": "allOptional",\n    "separatorsToIndex": "_",\n    "synonyms": [\n      ["js", "javascript"],\n      ["ts", "typescript"]\n    ]\n  }\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u8fd0\u884c docker \u547d\u4ee4"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sh",children:'docker run -it --env-file=.env -e "CONFIG=$(cat docsearch.json | jq -r tostring)" algolia/docsearch-scraper\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u63a5\u7740\u7b49\u5f85\u5bb9\u5668\u8fd0\u884c\uff0c\u722c\u53d6\u4f60\u7684\u7f51\u7ad9\u5373\u53ef\u3002\u6700\u7ec8\u6253\u5f00 algolia \u63a7\u5236\u53f0\u63d0\u793a\u5982\u4e0b\u9875\u9762\u5219\u8868\u793a\u6210\u529f"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://img.kuizuo.cn/image-20210821225934002.png",alt:"image-20210821225934002"})}),"\n",(0,r.jsx)(e.h4,{id:"\u4f7f\u7528-github-actions",children:"\u4f7f\u7528 github-actions"}),"\n",(0,r.jsx)(e.p,{children:"\u56e0\u4e3a\u8981\u786e\u4fdd\u9879\u76ee\u6210\u529f\u90e8\u7f72\u540e\u624d\u89e6\u53d1\uff0c\u5982\u679c\u91c7\u7528 vercel \u90e8\u7f72\u53ef\u4ee5\u6309\u7167\u5982\u4e0b\u89e6\u53d1\u6761\u4ef6\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",metastring:"title='.github/workflows/docsearch.yml' ",children:'name: docsearch\n\non:\n  deployment\n\njobs:\n  algolia:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v2\n\n      - name: Get the content of docsearch.json as config\n        id: algolia_config\n        run: echo "::set-output name=config::$(cat docsearch.json | jq -r tostring)"\n\n      - name: Run algolia/docsearch-scraper image\n        env:\n          ALGOLIA_APP_ID: ${{ secrets.ALGOLIA_APP_ID }}\n          ALGOLIA_API_KEY: ${{ secrets.ALGOLIA_API_KEY }}\n          CONFIG: ${{ steps.algolia_config.outputs.config }}\n        run: |\n          docker run \\\n            --env APPLICATION_ID=${ALGOLIA_APP_ID} \\\n            --env API_KEY=${ALGOLIA_API_KEY} \\\n            --env "CONFIG=${CONFIG}" \\\n            algolia/docsearch-scraper\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u6dfb\u52a0 ",(0,r.jsx)(e.a,{href:"https://docs.github.com/en/actions/security-guides/encrypted-secrets#creating-encrypted-secrets-for-a-repository",children:"secrets"})," \u5230\u4f60\u7684 Github \u4ed3\u5e93\u4e2d\uff0c\u63d0\u4ea4\u4ee3\u7801\u4fbf\u53ef\u89e6\u53d1\u722c\u866b\u89c4\u5219\u3002"]}),"\n",(0,r.jsx)(e.h2,{id:"\u672c\u5730\u641c\u7d22",children:"\u672c\u5730\u641c\u7d22"}),"\n",(0,r.jsx)(e.p,{children:"\u5982\u679c\u4f60\u5acc algolia \u7533\u8bf7\u6bd4\u8f83\u9ebb\u70e6\uff0cdocusaurus \u4e5f\u63d0\u4f9b\u672c\u5730\u641c\u7d22\uff0c\u4e0d\u8fc7\u641c\u7d22\u4e0a\u80af\u5b9a\u4f1a\u6bd4\u5168\u6587\u641c\u7d22\u6765\u7684\u5dee\u4e00\u4e9b\u3002"}),"\n",(0,r.jsxs)(e.p,{children:["\u672c\u5730\u641c\u7d22\u63d2\u4ef6\uff1a",(0,r.jsx)(e.a,{href:"https://github.com/cmfcmf/docusaurus-search-local",children:"docusaurus-search-local"})]})]})}e.default=function(n={}){const{wrapper:e}=Object.assign({},(0,i.ah)(),n.components);return e?(0,r.jsx)(e,Object.assign({},n,{children:(0,r.jsx)(u,n)})):u(n)}},11151:function(n,e,s){s.d(e,{Zo:function(){return t},ah:function(){return c}});var r=s(67294);const i=r.createContext({});function c(n){const e=r.useContext(i);return r.useMemo((()=>"function"==typeof n?n(e):{...e,...n}),[e,n])}const a={};function t({components:n,children:e,disableParentContext:s}){let t;return t=s?"function"==typeof n?n({}):n||a:c(n),r.createElement(i.Provider,{value:t},e)}}}]);